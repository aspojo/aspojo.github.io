"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6366],{6366:(O,T,s)=>{s.r(T),s.d(T,{ViewMessagePageModule:()=>B});var m=s(9808),c=s(2382),a=s(2723),d=s(8614),g=s(655),e=s(1223),A=s(3713),h=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.DestinationType={DATA_URL:0,FILE_URI:1,NATIVE_URI:2},o.EncodingType={JPEG:0,PNG:1},o.MediaType={PICTURE:0,VIDEO:1,ALLMEDIA:2},o.PictureSourceType={PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},o.PopoverArrowDirection={ARROW_UP:1,ARROW_DOWN:2,ARROW_LEFT:4,ARROW_RIGHT:8,ARROW_ANY:15},o.Direction={BACK:0,FRONT:1},o}return(0,g.ZT)(n,t),n.prototype.getPicture=function(o){return(0,A.DM)(this,"getPicture",{callbackOrder:"reverse"},arguments)},n.prototype.cleanup=function(){return(0,A.DM)(this,"cleanup",{platforms:["iOS"]},arguments)},n.\u0275fac=function(){let o;return function(r){return(o||(o=e.n5z(n)))(r||n)}}(),n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n.pluginName="Camera",n.plugin="cordova-plugin-camera",n.pluginRef="navigator.camera",n.repo="https://github.com/apache/cordova-plugin-camera",n.platforms=["Android","Browser","iOS","Windows"],n=(0,g.gn)([],n)}(A.On),v=s(520),w=s(2468);function M(t,n){if(1&t){const o=e.EpF();e.ynx(0),e.TgZ(1,"ion-thumbnail")(2,"ion-fab",37),e.NdJ("click",function(){const l=e.CHM(o).$implicit,u=e.oxw(2);return e.KtG(u.removeFile(l))}),e.TgZ(3,"ion-fab-button",38),e._UZ(4,"ion-icon",39),e.qZA()(),e._UZ(5,"img",40),e.qZA(),e.BQk()}if(2&t){const o=n.$implicit;e.xp6(5),e.Q6J("src",o,e.LSH)}}function P(t,n){1&t&&e._UZ(0,"ion-datetime",41),2&t&&e.Q6J("showDefaultButtons",!0)}function x(t,n){1&t&&e._UZ(0,"ion-datetime",42),2&t&&e.Q6J("showDefaultButtons",!0)}function Z(t,n){if(1&t&&(e.TgZ(0,"ion-select-option",43),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o.label)}}function D(t,n){if(1&t&&(e.TgZ(0,"ion-select-option",43),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o.label)}}function b(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"ion-select",44),e.NdJ("ionChange",function(){e.CHM(o);const r=e.oxw(2);return e.KtG(r.clearSelect(["area"]))}),e.YNc(1,D,2,2,"ion-select-option",29),e.qZA()}if(2&t){const o=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",o.jobForm.value.province.child)}}function C(t,n){if(1&t&&(e.TgZ(0,"ion-select-option",43),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o.label)}}function F(t,n){if(1&t&&(e.TgZ(0,"ion-select",45),e.YNc(1,C,2,2,"ion-select-option",29),e.qZA()),2&t){const o=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",o.jobForm.value.city.child)}}function I(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"ion-content",4)(1,"div",5)(2,"form",6)(3,"ion-list",7)(4,"ion-item",8)(5,"ion-text",9)(6,"ion-text",10),e._uU(7,"*"),e.qZA(),e._uU(8," \u73b0\u573a\u7167\u7247: "),e.qZA(),e.TgZ(9,"ion-grid")(10,"ion-row")(11,"ion-col",11),e._UZ(12,"ion-input",12),e.TgZ(13,"span"),e.YNc(14,M,6,1,"ng-container",13),e.qZA(),e.TgZ(15,"ion-thumbnail",14),e.NdJ("click",function(){e.CHM(o);const r=e.MAs(18),l=e.oxw();return e.KtG(l.addImg(r))}),e._UZ(16,"img",15)(17,"input",16,17),e.qZA()()()()(),e.TgZ(19,"ion-item",18)(20,"ion-label",9)(21,"ion-text",10),e._uU(22,"*"),e.qZA(),e._uU(23,"\u5b9a\u4f4d:"),e.qZA(),e.TgZ(24,"ion-input",19),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.getLocation())}),e.qZA()(),e.TgZ(25,"ion-item",18)(26,"ion-label",9)(27,"ion-text",10),e._uU(28,"*"),e.qZA(),e._uU(29,"\u5730\u5740:"),e.qZA(),e._UZ(30,"ion-input",20),e.qZA(),e.TgZ(31,"ion-item",18)(32,"ion-label",9)(33,"ion-text",10),e._uU(34,"*"),e.qZA(),e._uU(35,"\u5f00\u59cb\u65f6\u95f4:"),e.qZA(),e._UZ(36,"ion-input",21),e.ALo(37,"date"),e.TgZ(38,"ion-popover",22),e.YNc(39,P,1,1,"ng-template"),e.qZA()(),e.TgZ(40,"ion-item",18)(41,"ion-label",9)(42,"ion-text",10),e._uU(43,"*"),e.qZA(),e._uU(44,"\u5f00\u59cb\u65f6\u95f4:"),e.qZA(),e._UZ(45,"ion-input",23),e.ALo(46,"date"),e.TgZ(47,"ion-popover",24),e.YNc(48,x,1,1,"ng-template"),e.qZA()(),e.TgZ(49,"ion-item",18)(50,"ion-label",9)(51,"ion-text",10),e._uU(52,"*"),e.qZA(),e._uU(53,"\u6570\u5b57:"),e.qZA(),e._UZ(54,"ion-input",25),e.qZA(),e.TgZ(55,"ion-item",18)(56,"ion-label",9)(57,"ion-text",10),e._uU(58,"*"),e.qZA(),e._uU(59,"\u8eab\u4efd\u8bc1:"),e.qZA(),e._UZ(60,"ion-input",26),e.qZA(),e.TgZ(61,"ion-item",18)(62,"ion-label",9)(63,"ion-text",10),e._uU(64,"*"),e.qZA(),e._uU(65,"\u624b\u673a:"),e.qZA(),e._UZ(66,"ion-input",27),e.qZA(),e.TgZ(67,"ion-item",18)(68,"ion-label",9)(69,"ion-text",10),e._uU(70,"*"),e.qZA(),e._uU(71,"\u7701:"),e.qZA(),e.TgZ(72,"ion-select",28),e.NdJ("ionChange",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.clearSelect(["city","area"]))}),e.YNc(73,Z,2,2,"ion-select-option",29),e.qZA()(),e.TgZ(74,"ion-item",18)(75,"ion-label",9)(76,"ion-text",10),e._uU(77,"*"),e.qZA(),e._uU(78,"\u5e02:"),e.qZA(),e.YNc(79,b,2,1,"ion-select",30),e.qZA(),e.TgZ(80,"ion-item",18)(81,"ion-label",9)(82,"ion-text",10),e._uU(83,"*"),e.qZA(),e._uU(84,"\u53bf(\u533a):"),e.qZA(),e.YNc(85,F,2,1,"ion-select",31),e.qZA(),e.TgZ(86,"ion-item",18)(87,"ion-label",9)(88,"ion-text",10),e._uU(89,"*"),e.qZA(),e._uU(90,"\u7c7b\u578b:"),e.qZA(),e.TgZ(91,"ion-select",32)(92,"ion-select-option",33),e._uU(93,"\u7c7b\u578b1"),e.qZA(),e.TgZ(94,"ion-select-option",34),e._uU(95,"\u7c7b\u578b2"),e.qZA(),e.TgZ(96,"ion-select-option",35),e._uU(97,"\u7c7b\u578b3"),e.qZA()()()(),e.TgZ(98,"ion-button",36),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.saveMessage())}),e._uU(99," \u4fdd\u5b58 "),e.qZA()()()()}if(2&t){const o=e.oxw();e.Q6J("fullscreen",!0),e.xp6(2),e.Q6J("formGroup",o.jobForm),e.xp6(12),e.Q6J("ngForOf",o.imageArr),e.xp6(1),e.Q6J("hidden",!o.showAddImg),e.xp6(21),e.s9C("value",e.xi3(37,12,o.jobForm.value.beginTime,"yyy-MM-dd hh:mm")),e.xp6(9),e.s9C("value",e.xi3(46,15,o.jobForm.value.endTime,"yyy-MM-dd hh:mm")),e.xp6(28),e.Q6J("ngForOf",o.provinceList),e.xp6(6),e.Q6J("ngIf",o.jobForm.value.province),e.xp6(6),e.Q6J("ngIf",o.jobForm.value.city),e.xp6(6),e.Q6J("multiple",!0),e.xp6(7),e.Q6J("disabled",!o.jobForm.valid)("color",o.jobForm.valid?"":"medium")}}const R=[{path:"",component:(()=>{class t{constructor(o,i,r,l,u,p){this.alertController=o,this.camera=i,this.http=r,this.data=l,this.activatedRoute=u,this.router=p,this.showAddImg=!0,this.currentField="",this.beginTime=""}ngOnInit(){return(0,g.mG)(this,void 0,void 0,function*(){const o=this.activatedRoute.snapshot.paramMap.get("id");this.message="null"!=o?this.data.getMessageById(o):{id:Date.now()+100*Math.random(),imageArr:[],beginTime:Date.now(),endTime:Date.now(),num:4,idCard:"420325189801012343",phone:"13109091313"},this.jobForm=new c.cw({id:new c.NI(null,[]),imageArr:new c.NI(null,[]),position:new c.NI(null,[c.kI.required]),formattedAddress:new c.NI(null,[c.kI.required]),beginTime:new c.NI(null,[c.kI.required]),endTime:new c.NI(null,[c.kI.required]),num:new c.NI(null,[c.kI.required]),idCard:new c.NI(null,[c.kI.pattern(/^[1-9]\d{5}(18|19|20|(3\d))\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/)]),phone:new c.NI(null,[c.kI.pattern(/^1((34[0-8])|(8\d{2})|(([35][0-35-9]|4[579]|66|7[35678]|9[1389])\d{1}))\d{7}$/)]),province:new c.NI(null,[]),city:new c.NI(null,[]),area:new c.NI(null,[]),type:new c.NI(null,[])}),this.jobForm.patchValue(this.message),this.provinceList=yield this.data.getProvinceList().toPromise()})}get imageArr(){return this.jobForm&&this.jobForm.value?this.jobForm.value.imageArr:[]}addImg(o){return(0,g.mG)(this,void 0,void 0,function*(){let i={destinationType:this.camera.DestinationType.DATA_URL,saveToPhotoAlbum:!0};const r=yield this.alertController.create({header:"\u4e0a\u4f20\u56fe\u7247",buttons:[{text:"\u76f8\u518c",role:"cancel",handler:()=>{i.sourceType=this.camera.PictureSourceType.PHOTOLIBRARY}},{text:"\u62cd\u7167",role:"confirm",handler:()=>{i.sourceType=this.camera.PictureSourceType.CAMERA}}]});yield r.present();const{role:l}=yield r.onDidDismiss();if(r.dismiss(),console.log(`Dismissed with role: ${l}`),window.cordova){const u=yield this.camera.getPicture(i);console.log("addImg",u.length);const p=class y{static base64toBlob(n,o="",i=512){const r=atob(n),l=[];for(let u=0;u<r.length;u+=i){const p=r.slice(u,u+i),f=new Array(p.length);for(let _=0;_<p.length;_++)f[_]=p.charCodeAt(_);const N=new Uint8Array(f);l.push(N)}return new Blob(l,{type:o})}}.base64toBlob(u);this.uploadFile(p)}else o.onchange=u=>(0,g.mG)(this,void 0,void 0,function*(){yield this.uploadFile(u.target.files[0]),o.value=null})})}uploadFile(o){return(0,g.mG)(this,void 0,void 0,function*(){console.log("fileBlob",o);const i=new FormData;i.append("file",o);const r=yield this.data.uploadImage(i).toPromise();console.log("\u4e0a\u4f20\u6210\u529f\uff1a",r),this.imageArr.push(r.data.url),5===this.imageArr.length&&(this.showAddImg=!1),this.jobForm.patchValue({imageArr:this.imageArr})})}removeFile(o){this.jobForm.patchValue({imageArr:this.imageArr.filter((i,r)=>r!==this.imageArr.findIndex(l=>l===o))}),this.imageArr.length<5&&(this.showAddImg=!0)}getBackButtonText(){const o=window;return"ios"===(o&&o.Ionic&&o.Ionic.mode)?"Inbox":""}saveMessage(){this.data.saveMessage(this.jobForm.value),this.router.navigate(["../"])}getLocation1(){let o=new AMap.Map("iCenter");o.plugin("AMap.Geolocation",()=>{let i=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"LB",buttonOffset:new AMap.Pixel(10,20),showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0});o.addControl(i),i.getCurrentPosition(),AMap.event.addListener(i,"complete",r=>{console.log(r),this.jobForm.patchValue(r)}),AMap.event.addListener(i,"error",r=>{console.log(r)})})}getLocation(){AMap.plugin("AMap.Geolocation",()=>{let o=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"LB",buttonOffset:new AMap.Pixel(10,20),showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0});o.getCurrentPosition(),AMap.event.addListener(o,"complete",i=>{console.log("\u5b9a\u4f4d\u6210\u529f\uff1a",i),this.jobForm.patchValue(i)}),AMap.event.addListener(o,"error",i=>{console.error("\u5b9a\u4f4d\u5931\u8d25\uff1a",i)})})}clearSelect(o){const i={};for(const r of o)i[r]=null;this.jobForm.patchValue(i)}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(a.Br),e.Y36(h),e.Y36(v.eN),e.Y36(w.D),e.Y36(d.gz),e.Y36(d.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-view-message"]],viewQuery:function(o,i){if(1&o&&e.Gf(a.ki,5),2&o){let r;e.iGM(r=e.CRH())&&(i.modal=r.first)}},decls:5,vars:2,consts:[[3,"translucent"],["slot","start"],["defaultHref","/"],[3,"fullscreen",4,"ngIf"],[3,"fullscreen"],[1,"ion-padding"],["role","form",1,"my-form",3,"formGroup"],["lines","none"],[1,"img-arr","ion-no-padding"],["fixed","",1,"my-form-label"],["color","danger"],["size","12"],["formControlName","imageArr","hidden",""],[4,"ngFor","ngForOf"],[1,"ion-margin-end",3,"hidden","click"],["src","assets/camera.png"],["type","file","hidden",""],["browserSupportInput",""],[1,"ion-no-padding"],["placeholder","\u8bf7\u8f93\u5165","formControlName","position","readonly","",3,"click"],["placeholder","\u8bf7\u8f93\u5165","formControlName","formattedAddress","readonly",""],["placeholder","\u8bf7\u8f93\u5165","formControlName","beginTime","id","beginTime",3,"value"],["trigger","beginTime","size","cover"],["placeholder","\u8bf7\u8f93\u5165","formControlName","endTime","id","endTime",3,"value"],["trigger","endTime","size","cover"],["placeholder","\u8bf7\u8f93\u5165","formControlName","num","type","number"],["placeholder","\u8bf7\u8f93\u5165","formControlName","idCard"],["placeholder","\u8bf7\u8f93\u5165","formControlName","phone"],["formControlName","province","cancelText","\u53d6\u6d88","okText","\u786e\u5b9a","interface","action-sheet",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","city","cancelText","\u53d6\u6d88","okText","\u786e\u5b9a","interface","action-sheet",3,"ionChange",4,"ngIf"],["formControlName","area","cancelText","\u53d6\u6d88","okText","\u786e\u5b9a","interface","action-sheet",4,"ngIf"],["formControlName","type",3,"multiple"],["value","apples"],["value","oranges"],["value","bananas"],["expand","block",3,"disabled","color","click"],["vertical","top","horizontal","end",3,"click"],["color","danger",2,"width","15px","height","15px"],["name","close"],[3,"src"],["formControlName","beginTime","locale","zh-CN","doneText","\u786e\u5b9a","cancelText","\u53d6\u6d88",3,"showDefaultButtons"],["formControlName","endTime","locale","zh-CN","doneText","\u786e\u5b9a","cancelText","\u53d6\u6d88",3,"showDefaultButtons"],[3,"value"],["formControlName","city","cancelText","\u53d6\u6d88","okText","\u786e\u5b9a","interface","action-sheet",3,"ionChange"],["formControlName","area","cancelText","\u53d6\u6d88","okText","\u786e\u5b9a","interface","action-sheet"]],template:function(o,i){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA()()(),e.YNc(4,I,100,18,"ion-content",3)),2&o&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngIf",i.message))},dependencies:[m.sg,m.O5,c._Y,c.JJ,c.JL,a.oU,a.YG,a.Sm,a.wI,a.W2,a.x4,a.IJ,a.W4,a.jY,a.Gu,a.gu,a.pK,a.Ie,a.Q$,a.q_,a.Nd,a.t9,a.n0,a.yW,a.Bs,a.sr,a.d8,a.as,a.QI,a.j9,a.cs,c.sg,c.u,m.uU],styles:[".img-arr[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{display:inline-block;margin-right:10px;margin-top:10px;float:left;position:relative}.img-arr[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{top:-5px;right:-5px}.my-form[_ngcontent-%COMP%]   .my-form-label[_ngcontent-%COMP%]{max-width:80px;width:80px}"]}),t})()}];let U=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.Bz.forChild(R),d.Bz]}),t})(),B=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[h],imports:[m.ez,c.u5,a.Pc,U,c.UX]}),t})()}}]);